{"code":"var cellSize = [80, 80];\nvar pieRadius = 30;\n\nfunction getVirtulData() {\n    var date = +echarts.number.parseDate('2017-02-01');\n    var end = +echarts.number.parseDate('2017-03-01');\n    var dayTime = 3600 * 24 * 1000;\n    var data = [];\n    for (var time = date; time < end; time += dayTime) {\n        data.push([\n            echarts.format.formatTime('yyyy-MM-dd', time),\n            Math.floor(Math.random() * 10000)\n        ]);\n    }\n    return data;\n}\n\nfunction getPieSeries(scatterData, chart) {\n    return echarts.util.map(scatterData, function (item, index) {\n        var center = chart.convertToPixel('calendar', item);\n        return {\n            id: index + 'pie',\n            type: 'pie',\n            center: center,\n            label: {\n                normal: {\n                    formatter: '{c}',\n                    position: 'inside'\n                }\n            },\n            radius: pieRadius,\n            data: [\n                {name: '工作', value: Math.round(Math.random() * 24)},\n                {name: '娱乐', value: Math.round(Math.random() * 24)},\n                {name: '睡觉', value: Math.round(Math.random() * 24)}\n            ]\n        };\n    });\n}\n\nfunction getPieSeriesUpdate(scatterData, chart) {\n    return echarts.util.map(scatterData, function (item, index) {\n        var center = chart.convertToPixel('calendar', item);\n        return {\n            id: index + 'pie',\n            center: center\n        };\n    });\n}\n\nvar scatterData = getVirtulData();\n\noption = {\n    tooltip : {},\n    legend: {\n        data: ['工作', '娱乐', '睡觉'],\n        bottom: 20\n    },\n    calendar: {\n        top: 'middle',\n        left: 'center',\n        orient: 'vertical',\n        cellSize: cellSize,\n        yearLabel: {\n            show: false,\n            textStyle: {\n                fontSize: 30\n            }\n        },\n        dayLabel: {\n            margin: 20,\n            firstDay: 1,\n            nameMap: ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六']\n        },\n        monthLabel: {\n            show: false\n        },\n        range: ['2017-02']\n    },\n    series: [{\n        id: 'label',\n        type: 'scatter',\n        coordinateSystem: 'calendar',\n        symbolSize: 1,\n        label: {\n            normal: {\n                show: true,\n                formatter: function (params) {\n                    return echarts.format.formatTime('dd', params.value[0]);\n                },\n                offset: [-cellSize[0] / 2 + 10, -cellSize[1] / 2 + 10],\n                textStyle: {\n                    color: '#000',\n                    fontSize: 14\n                }\n            }\n        },\n        data: scatterData\n    }]\n};\n\nif (!app.inNode) {\n    var pieInitialized;\n    setTimeout(function () {\n        pieInitialized = true;\n        myChart.setOption({\n            series: getPieSeries(scatterData, myChart)\n        });\n    }, 10);\n\n    app.onresize = function () {\n        if (pieInitialized) {\n            myChart.setOption({\n                series: getPieSeriesUpdate(scatterData, myChart)\n            });\n        }\n    };\n}"}