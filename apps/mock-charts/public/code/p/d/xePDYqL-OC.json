{"code":"app.title = '堆叠条形图联动饼状图';\n\nvar data = [\n    [56, 36, 25, 39, 95, 99],\n    [26, 86, 65, 49, 45, 39],\n    [28, 46, 35, 89, 15, 79],\n    [16, 56, 85, 29, 75, 49]\n]\nvar arr=['product', '桐庐', '城南', '旧县', '城乡', '固始', '千岛湖']\noption = {\n    legend: {},\n    tooltip: {\n        trigger: 'axis',\n        showContent: true,\n        position: 'inside',\n    },\n    dataset: {\n        source: [\n            arr,\n            ['心电', 56, 36, 25, 39, 95, 99],\n            ['血压', 26, 86, 65, 49, 45, 39],\n            ['心率', 28, 46, 35, 89, 15, 79],\n            ['化验', 16, 56, 85, 29, 75, 49]\n        ]\n    },\n    xAxis: {\n        type: 'category'\n    },\n    yAxis: {\n        gridIndex: 0\n    },\n    grid: {\n        top: '20%',\n        right: \"45%\",\n    },\n    series: [{\n            type: 'bar',\n            stack: '总量',\n            label: {\n                normal: {\n                    show: true,\n                    position: 'insideRight'\n                }\n            },\n            smooth: true,\n            seriesLayoutBy: 'row'\n        },\n        {\n            type: 'bar',\n            smooth: true,\n            stack: '总量',\n            label: {\n                normal: {\n                    show: true,\n                    position: 'insideRight'\n                }\n            },\n            seriesLayoutBy: 'row'\n        },\n        {\n            type: 'bar',\n            smooth: true,\n            stack: '总量',\n            label: {\n                normal: {\n                    show: true,\n                    position: 'insideRight'\n                }\n            },\n            seriesLayoutBy: 'row'\n        },\n        {\n            type: 'bar',\n            smooth: true,\n            stack: '总量',\n            label: {\n                normal: {\n                    show: true,\n                    position: 'insideRight'\n                }\n            },\n            seriesLayoutBy: 'row'\n        },\n        {\n            name: '总计',\n            type: 'line', // 平均值\n            data: (function() {\n                let sum = []\n                for (let i in data) {\n                    for (let j in data[i]) {\n                        if (!sum[j]) {\n                            sum[j] = 0\n                        }\n                        sum[j] += data[i][j]\n                    }\n                }\n                return sum\n            })(),\n            itemStyle: {\n                opacity: 0\n            },\n            lineStyle: {\n                opacity: 0\n            },\n            markLine: {\n                data: [{\n                    type: 'average',\n                    name: '平均数',\n                    label: {\n                        normal: {\n                            position: 'end',\n                            formatter: '{b}: {c}'\n                        }\n                    }\n                }]\n            }\n        },\n        {\n            tooltip: {\n                trigger: 'item',\n                showContent: true,\n                alwaysShowContent: true,\n                 position: 'inside',\n            },\n            type: 'pie',\n            id: 'pie',\n            radius: '24%',\n            center: ['78%', '50%'],\n            label: {\n                formatter: '{b}: {@旧县} ({d}%)',\n                /* normal: {\n                     position: 'inner'\n                 }*/\n            },\n            /*labelLine: {\n                normal: {\n                    show: false\n                }\n            },*/\n            encode: {\n                itemName: 'product',\n                value: '旧县',\n                tooltip: '旧县'\n            }\n        }\n    ]\n};\nmyChart.on('updateAxisPointer', function(event) {\n    var xAxisInfo = event.axesInfo[0];\n    if (xAxisInfo) {\n        var dimension = xAxisInfo.value + 1;\n        myChart.setOption({\n            series: {\n                name:arr[dimension],\n                id: 'pie',\n                label: {\n                    formatter: '{a} {b}: {@[' + dimension + ']} ({d}%)',\n                },\n                encode: {\n                    value: dimension,\n                    tooltip: dimension\n                }\n            }\n        });\n    }\n});"}