{"code":"var jiangsuMapJson = '/asset/get/s/data-1641366415167-sVovDceF5.json';\n\nvar jiangsuOutline = '/asset/get/s/data-1641366419439-UFsbPgpeW.json';\n\n\nfunction convertData(data) {\n  var res = [];\n  for (var i = 0; i < data.length; i++) {\n    var geoCoord = cityCenter[data[i].name];\n    if (geoCoord) {\n      res.push({\n        name: data[i].name,\n        value: geoCoord.concat(data[i].value),\n      });\n    }\n  }\n  return res;\n}\nconst cityCenter = {\n  南京市: [118.667413, 31.841544],\n  无锡市: [120.201663, 31.474729],\n  徐州市: [117.584811, 34.261792],\n  常州市: [119.646973, 31.672752],\n  苏州市: [120.419585, 31.099379],\n  南通市: [120.964608, 32.116212],\n  连云港市: [118.978821, 34.500018],\n  淮安市: [119.121265, 33.497506],\n  盐城市: [120.239998, 33.277631],\n  扬州市: [119.321003, 32.693159],\n  镇江市: [119.452753, 31.954402],\n  泰州市: [120.015176, 32.384882],\n  宿迁市: [118.375162, 33.863008],\n};\nlet regions = [\n  {\n    name: '南京市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(8, 114, 204, 1)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(83, 190, 236, 0.8)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n      color: 'red',\n    },\n  },\n  {\n    name: '徐州市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(22, 159, 255, 1)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(22, 159, 255, 0.7)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n      color: 'red',\n    },\n  },\n  {\n    name: '盐城市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(8, 114, 204, 1)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(8, 114, 204, 0.8)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n      color: 'red',\n    },\n  },\n  {\n    name: '南通市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(8, 114, 204, 0.9)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(8, 114, 204, 0.7)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n      color: 'red',\n    },\n  },\n  {\n    name: '淮安市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(22, 159, 255, 0.9)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(22, 159, 255, 0.65)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n      color: 'red',\n    },\n  },\n  {\n    name: '扬州市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(14, 64, 157, 0.9)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(14, 64, 157, 0.8)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n      color: 'red',\n    },\n  },\n  {\n    name: '宿迁市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(14, 64, 157, 0.5)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(14, 64, 157, 0.3)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n      color: 'red',\n    },\n  },\n  {\n    name: '常州市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(14, 64, 157, 0.8)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(14, 64, 157, 0.7)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n      color: 'red',\n    },\n  },\n  {\n    name: '苏州市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(35, 209, 255, 0.9)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(35, 209, 255, 0.7)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n    },\n  },\n  {\n    name: '无锡市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(35, 209, 255, 1)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(35, 209, 255, 0.8)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n    },\n  },\n  {\n    name: '镇江市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(35, 209, 255, 0.9)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(35, 209, 255, 0.8)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n    },\n  },\n  {\n    name: '泰州市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(35, 242, 255, 0.9)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(35, 242, 255, 0.7)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n    },\n  },\n  {\n    name: '连云港市',\n    itemStyle: {\n      areaColor: {\n        type: 'radial',\n        x: 0.5,\n        y: 0.5,\n        r: 0.5,\n        colorStops: [\n          {\n            offset: 0,\n            color: 'rgba(35, 242, 255, 0.9)', // 0% 处的颜色\n          },\n          {\n            offset: 1,\n            color: 'rgba(35, 242, 255, 0.7)', // 100% 处的颜色\n          },\n        ],\n        global: false, // 缺省为 false\n      },\n    },\n  },\n];\nconst aspectScale = 1.2;\nconst zoom = 1;\nfunction getRandomNum(min, max) {\n  return Math.floor(Math.random() * (max - min)) + min;\n}\nconst dataMap = [\n  {\n    name: \"南京市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"无锡市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"徐州市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"常州市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"苏州市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"南通市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"连云港市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"淮安市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"盐城市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"扬州市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"镇江市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"泰州市\",\n    value: getRandomNum(0, 100)\n  },\n  {\n    name: \"宿迁市\",\n    value: getRandomNum(0, 100)\n  }\n];\n$.getJSON(jiangsuMapJson, function (geoJson) {\n  $.getJSON(jiangsuOutline, function (geoJsonOutline) {\n    echarts.registerMap('jiangsu', geoJson);\n    echarts.registerMap('jiangsuOutline', geoJsonOutline);\n    echarts.registerMap('jiangsuOutline2', geoJsonOutline);\n    let option = {\n      geo: [\n        {\n          name: 'jiangsu',\n          map: 'jiangsu',\n          roam: false, //是否允许缩放\n          zoom: zoom, //默认显示级别\n          z: 199,\n          aspectScale: aspectScale, //地图长宽比\n          // layoutSize: \"100%\",\n          scaleLimit: {\n            //缩放级别\n            min: 0.5,\n            max: 2,\n          },\n          label: {\n            normal: {\n              show: true,\n              color: '#fff',\n              fontSize: 15,\n            },\n            emphasis: {\n              show: true,\n              color: '#fff',\n              fontSize: 15,\n            },\n          },\n          itemStyle: {\n            normal: {\n              borderColor: '#17caf0',\n              borderWidth: 2,\n              borderType: 'solid',\n            },\n          },\n          emphasis: {\n            itemStyle: {\n              areaColor: 'rgba(14,64,157,1)',\n              shadowColor: 'rgba(254,240,59,0.7)',\n              shadowBlur: 30,\n              borderColor: 'rgba(254,240,59,0.6)',\n              borderWidth: 2,\n            },\n          },\n          regions: regions,\n        },\n      ],\n      series: [\n        // outline1\n        {\n          type: 'map',\n          map: 'jiangsuOutline',\n          aspectScale: aspectScale, //地图长宽比\n          zoom: zoom, //默认显示级别\n          z: 99,\n          // geoIndex: 0,\n          roam: true,\n          scaleLimit: {\n            //缩放级别\n            min: 0.5,\n            max: 2,\n          },\n          itemStyle: {\n            normal: {\n              shadowColor: 'rgba(85,184,247,0.2)',\n              shadowOffsetX: -10,\n              shadowOffsetY: 10,\n              areaColor: 'transparent',\n              borderColor: '#17caf0',\n              borderWidth: 2,\n              borderType: 'solid',\n            },\n          },\n          label: {\n            normal: {\n              show: false,\n            },\n            emphasis: {\n              show: false,\n            },\n          },\n        },\n        //outline12\n        {\n          type: 'map',\n          map: 'jiangsuOutline2',\n          aspectScale: aspectScale, //地图长宽比\n          zoom: zoom, //默认显示级别\n          z: 99,\n          roam: true,\n          scaleLimit: {\n            //缩放级别\n            min: 0.5,\n            max: 2,\n          },\n          itemStyle: {\n            normal: {\n              shadowColor: 'rgba(85,184,247,0.2)',\n              shadowOffsetX: -20,\n              shadowOffsetY: 20,\n              areaColor: 'transparent',\n              borderColor: '#17caf0',\n              borderWidth: 2,\n              borderType: 'solid',\n            },\n          },\n          label: {\n            normal: {\n              show: false,\n            },\n            emphasis: {\n              show: false,\n            },\n          },\n        },\n        {\n          type: 'effectScatter',\n          name: 'Top 5',\n          legendHoverLink: true,\n          coordinateSystem: 'geo',\n          data: convertData(\n            dataMap\n              .sort(function (a, b) {\n                return b.value - a.value;\n              })\n              .slice(0, 20)\n          ),\n          symbolSize: 15,\n          showEffectOn: 'render',\n          rippleEffect: {\n            brushType: 'stroke',\n          },\n          hoverAnimation: true,\n          geoIndex: 0,\n          label: {\n            normal: {\n              formatter: '{b}',\n              position: 'left',\n              show: false,\n            },\n          },\n          itemStyle: {\n            normal: {\n              color: 'rgba(255, 225, 0, 1)',\n              shadowBlur: 8,\n              shadowColor: 'rgba(255, 225, 0, 1)',\n            },\n          },\n          zlevel: 1,\n        },\n      ],\n      animation: false,\n    };\n    myChart.setOption(option);\n    // 监听地图缩放 移动事件\n    myChart.on(\"georoam\", function(params) {\n      var option = myChart.getOption(); //获得option对象\n      if (params.zoom != null && params.zoom != undefined) {\n        //捕捉到缩放时\n        option.geo[0].zoom = option.series[0].zoom; //下层geo的缩放等级跟着上层的geo一起改变\n        option.geo[0].center = option.series[0].center; //下层的geo的中心位置随着上层geo一起改变\n      } else {\n        //捕捉到拖曳时\n        option.geo[0].center = option.series[0].center; //下层的geo的中心位置随着上层geo一起改变\n      }\n      myChart.setOption(option); //设置option\n    });\n    myChart.on(\"mouseover\", function(params) {\n      let pointArr = [];\n      for (let key in cityCenter) {\n        if (key == params.name) {\n          pointArr = cityCenter[key];\n        }\n      }\n      // 获取系列\n      var seriesModel = myChart.getModel().getSeriesByIndex(0);\n      // 获取地理坐标系实例\n      var coordSys = seriesModel.coordinateSystem;\n      // dataToPoint 相当于 getPosByGeo\n      var point = coordSys.dataToPoint(pointArr);\n      // pointToData 相当于 getGeoByPos\n      //var coord = coordSys.dataToPoint(point);\n      console.log(point)\n    });\n  });\n});\n"}