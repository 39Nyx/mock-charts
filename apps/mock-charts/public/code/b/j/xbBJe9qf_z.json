{"code":"var ckqList = [{\n    year: '2013',\n    value: -3\n},{\n    year: '2014',\n    value: -2\n},{\n    year: '2015',\n    value: 0\n},{\n    year: '2016',\n    value: -1\n},{\n    year: '2017',\n    value: 2\n},{\n    year: '2018',\n    value: 2\n},{\n    year: '2019',\n    value: 3\n},{\n    year: '2020',\n    value: 5\n}];\n\nvar xData = [],\n    data1 = [],\n    data2 = [],\n    data3 = [],\n    data4 = [];\n\nfor (var i=0; i<ckqList.length; i++) {\n    xData.push(ckqList[i].year);\n    data4.push([i, ckqList[i].value]);\n    data2.push(1);\n}\n\n\nvar myRegression = ecStat.regression('linear', data4, 3);\nmyRegression.points.sort(function(a, b) {\n    return a[0] - b[0];\n});\ndata3 = myRegression.points;\n\nvar data3Min = 0;\nfor (var j=0; j<data3.length; j++) {\n    let num = (data3[j][1] - 0.5).toFixed(3);\n    data1.push(Number(num));\n    \n    if (Number(num) < data3Min) {\n        data3Min = Number(num);\n    }\n}\n\nvar data4Min = 0;\nfor (var i=0; i<data4.length; i++) {\n    if (Number(data4[i][1]) < data4Min) {\n        data4Min = Number(data4[i][1]);\n    }\n}\n\n\nvar min = 0;\nif (data3Min < 0 || data4Min < 0) {\n    if (data3Min < data4Min) {\n        min = -data3Min;\n    } else {\n        min = -data4Min;\n    }\n    \n    min = Math.ceil(min);\n\n    for (var i=0; i<data4.length; i++) {\n        data1[i] = data1[i] + min;\n        data3[i][1] = data3[i][1] + min;\n        data4[i][1] = data4[i][1] + min;\n    }\n}\n\noption = {\n    toolbox: {\n        show: true,\n        feature: {\n            saveAsImage: {\n                show: true\n            }\n        },\n        x: \"right\",\n        y: 12,\n        padding: 10,\n        itemSize: 14\n    },\n    tooltip: {\n        trigger: 'axis',\n        axisPointer: {\n            type: 'line',\n        },\n        formatter: function (params, ticket, callback) {\n            let msgStr = params[0].axisValue + \"<br>\";\n            let vl1 = params[0].value - min;\n            let vl2 = params[0].value + params[1].value - min;\n            vl1 = vl1.toFixed(3);\n            vl2 = vl2.toFixed(3);\n            msgStr += \"95%置信区间：\"+vl1+\" mil k㎡ ~ \"+vl2+\" mil k㎡<br>\";\n            msgStr += \"异常值：\"+(params[3].value[1] - min)+\" mil km2\";\n            return msgStr;\n        }\n    },\n    calculable: false,\n    xAxis: {\n        name: '年',\n        type: 'category',\n        boundaryGap: false,\n        data: xData,\n        axisLine: {\n            lineStyle: {\n                color: \"rgba(0,0,0,0.7)\"\n            }\n        },\n        splitLine: {\n            show: false\n        },\n        axisTick: {\n            show: true,\n            lineStyle: {\n                color: \"rgba(0,0,0,0.85)\"\n            }\n        },\n        axisLabel: {\n            textStyle: {\n                fontSize: 12,\n                color: \"rgba(0,0,0,0.85)\"\n            }\n        }\n    },\n    yAxis: {\n        type: 'value',\n        name: 'million k㎡',\n        axisLabel: {\n            formatter: function (value, index) {\n                // 格式化成月/日，只在第一个刻度显示年份\n                var str = value - min;\n                return str;\n            }\n        },\n        axisLine: {\n            lineStyle: {\n                color: \"rgba(0,0,0,0.7)\"\n            }\n        },\n        splitLine: {\n            show: false\n        }\n    },\n    series: [{\n        name: '最小值',\n        type: 'line',\n        stack: '总量',\n        data: data1,\n        symbol: 'none',\n        areaStyle: { // 填充区域\n            color: 'rgba(255,255,255,0)'\n        },\n        lineStyle: {\n            normal: {\n                width: 0\n            }\n        }\n    },{\n        name: '差值',\n        type: 'line',\n        stack: '总量',\n        data: data2,\n        symbol: 'none',\n        areaStyle: { // 填充区域\n            normal: {\n                color: '#ddd'\n            }\n        },\n        lineStyle: {\n            normal: {\n                width: 0\n            }\n        }\n    },{\n        name: '线性回归',\n        type: 'line',\n        smooth: true,\n        showSymbol: false,\n        data: data3,\n        symbol: 'none',\n        lineStyle: {\n            normal: {\n                color: '#aaa',\n                type: 'dashed',\n                width: 1\n            }\n        }\n    },{\n        name: '折线',\n        type: 'line',\n        data: data4,\n        lineStyle: {\n            normal: {\n                color: '#222'\n            }\n        },\n        symbol: 'diamond',\n        symbolSize: 8,\n        itemStyle: {\n            normal: {\n                color: '#222'\n            }\n        }\n    }],\n    grid: {\n        x: 80,\n        y: 35,\n        x2: 60,\n        y2: 50,\n        borderWidth: 0,\n        containLabel: true\n    }\n};\n"}