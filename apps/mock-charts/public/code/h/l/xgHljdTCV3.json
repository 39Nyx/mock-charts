{"code":" let history = {\r\n          color: ['#33FF99','#33FF99','#ff3333','ffa033'],\r\n          targetDate:[{\r\n\t\t\t\"color\": \"#33FF99\",\r\n\t\t\t\"levelCode\": \"10001\",\r\n\t\t\t\"levelName\": \"优\",\r\n\t\t\t\"targetDate\": \"2021-08-15\"\r\n\t\t}, {\r\n\t\t\t\"color\": \"#33FF99\",\r\n\t\t\t\"levelCode\": \"10001\",\r\n\t\t\t\"levelName\": \"优\",\r\n\t\t\t\"targetDate\": \"2021-08-16\"\r\n\t\t}, {\r\n\t\t\t\"color\": \"#ff3333\",\r\n\t\t\t\"levelCode\": \"10004\",\r\n\t\t\t\"levelName\": \"差\",\r\n\t\t\t\"targetDate\": \"2021-08-30\"\r\n\t\t}, {\r\n\t\t\t\"color\": \"#ffa033\",\r\n\t\t\t\"levelCode\": \"10003\",\r\n\t\t\t\"levelName\": \"中\",\r\n\t\t\t\"targetDate\": \"2021-08-31\"\r\n\t\t}],\r\n          levelName: ['优','良','中','差']\r\n        };\r\n \r\n    let maxArr = [];\r\n\r\n    let month = new Date('2021-08').getMonth() + 1; //获取当前月\r\n    var year = new Date('2021-08').getFullYear(); //获取当前年\r\n    var datas = []; //新建日期数组\r\n    var dataLength = new Date(year, month).toJSON().substring(0, 10).split('-')[2]; //获取当前年月日期最大值\r\n    for (var i = 0; i < Number(dataLength); i++) {\r\n      let months = month >= 10 ? month : '0' + month;\r\n      let day = i + 1 >= 10 ? i + 1 : '0' + (i + 1);\r\n      datas.push({ date: year + '-' + months + '-' + day, total: 0, statu: history.levelName[i] ? history.levelName[i] : '优' }); //存入数组\r\n    }\r\n    let chartData = [];\r\n    let chartData1 = [];\r\n    let color = history.color;\r\n    datas.forEach((item, index) => {\r\n      if(history.targetDate.length>0){\r\n        history.targetDate.map((itm,index1)=>{\r\n          if(item.date == itm.targetDate){\r\n            maxArr.push(item.total);\r\n            chartData1.push({\r\n              name: item.statu,\r\n              value: [item.date, item.total],\r\n              symbolSize: 1,\r\n              label: {\r\n                show: true,\r\n                formatter: function (params) {\r\n                  return '\\n▂';\r\n                },\r\n                color: itm.color?itm.color : 'transparent',\r\n                fontSize: 18,\r\n              },\r\n            });\r\n            chartData.push({\r\n              name: item.statu,\r\n              value: [item.date, item.total],\r\n            });\r\n  \r\n          }else {\r\n            maxArr.push(item.total);\r\n            chartData1.push({\r\n              name: item.statu,\r\n              value: [item.date, item.total],\r\n              symbolSize: 1,\r\n              label: {\r\n                show: true,\r\n                formatter: function (params) {\r\n                  return '\\n▂';\r\n                },\r\n                color: 'transparent',\r\n                fontSize: 18,\r\n              },\r\n            });\r\n            chartData.push({\r\n              name: item.statu,\r\n              value: [item.date, item.total],\r\n            });\r\n          }\r\n        })\r\n      }\r\n      else {\r\n        maxArr.push(item.total);\r\n        chartData1.push({\r\n          name: item.statu,\r\n          value: [item.date, item.total],\r\n          symbolSize: 1,\r\n          label: {\r\n            show: true,\r\n            formatter: function (params) {\r\n              return '\\n▂';\r\n            },\r\n            color: 'transparent',\r\n            fontSize: 18,\r\n          },\r\n        });\r\n        chartData.push({\r\n          name: item.statu,\r\n          value: [item.date, item.total],\r\n        });\r\n      }\r\n\r\n    });\r\n    let thisMonth = '2021-08'; //当前月份\r\n\r\noption = {\r\n\r\n      visualMap: {\r\n        min: 0,\r\n        max: 300,\r\n        inRange: {\r\n          color: ['rgb(9,5,27)'],\r\n        },\r\n        show: false,\r\n      },\r\n      calendar: {\r\n        cellSize: [48, 48],\r\n        left: 'center',\r\n        top: 'middle',\r\n        orient: 'vertical',\r\n        range: [thisMonth],\r\n        itemStyle: {\r\n          borderWidth: 0,\r\n        },\r\n        splitLine: {\r\n          show: false,\r\n        },\r\n        yearLabel: { show: false },\r\n        monthLabel: {\r\n          show: false,\r\n        },\r\n        dayLabel: {\r\n          show: false,\r\n          firstDay: 1,\r\n          margin: 10,\r\n          nameMap: 'cn',\r\n        },\r\n      },\r\n      series: [\r\n        {\r\n          type: 'scatter',\r\n          coordinateSystem: 'calendar',\r\n          symbolSize: 1,\r\n          label: {\r\n            normal: {\r\n              show: true,\r\n              formatter: function (params) {\r\n                var d = echarts.number.parseDate(params.value[0]);\r\n                return d.getDate();\r\n              },\r\n              textStyle: {\r\n                color: '#7FA1C5',\r\n                fontSize: 18,\r\n                fontWeight: 'bold'\r\n              },\r\n            },\r\n          },\r\n          data: chartData,\r\n        },\r\n        {\r\n          type: 'heatmap',\r\n          coordinateSystem: 'calendar',\r\n          data: chartData,\r\n        },\r\n        {\r\n          type: 'scatter',\r\n          coordinateSystem: 'calendar',\r\n          data: chartData1,\r\n        },\r\n      ],\r\n    };"}