{"code":"//关于这个图表我做的视频简介：https://www.bilibili.com/video/BV1pD4y127tW\n//各位观众老爷们一键三连，下次一定！\n\nvar uploadedDataURL = \"/asset/get/s/data-1555851394070-aGGRVy22M.json\";\n\n\n //原始数据为栅格数据，需将栅格转化为经纬度后可视化\n\n//mapboxgl.accessToken = mapboxglToken;\n\nmyChart.showLoading();\n\nfunction coltowgs(LONCOL, LATCOL) { //定义栅格转换经纬度的函数\nvar lon1 = 118.36;\nvar lon2 = 121.986379;\nvar lat1 = 30.67;\nvar lat2 = 33.402324;\n    var accuracy = 1000;\n    var latStart = Math.min(lat1, lat2);\n    var lonStart = Math.min(lon1, lon2);\n    var deltaLon = accuracy * 360 / (2 * Math.PI * 6371004 * Math.cos((lat1 + lat2) * Math.PI / 360));\n    var deltaLat = accuracy * 360 / (2 * Math.PI * 6371004);\n    var HBLON = LONCOL * deltaLon + (lonStart - deltaLon / 2)\n    var HBLAT = LATCOL * deltaLat + (latStart - deltaLat / 2)\n    return [HBLON, HBLAT]\n}\n//读取MapboxStyle数据\nvar option = {\n    title: {\n        text: \"上海到南京出行轨迹\",\n        textStyle: {\n            color: '#fff',\n            fontSize: 30\n        },\n        right: '0%'\n    },\n\n    visualMap: {\n        show: false,\n        calculable: true,\n        realtime: false,\n        dimension:3,\n        inRange: {\n            color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']\n        },\n        outOfRange: {\n            colorAlpha: 0\n        }\n\n    },\n\n\n    maptalks3D      : {\n    center          : [120.0693, 31.713070],\n    zoom            : 8,\n    pitch           : 10,\n    urlTemplate     : 'http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png',\n    // altitudeScale: 1,\n    postEffect      : {\n    enable          : true,\n    FXAA            : {\n    enable          : true\n            }\n        },\n        light: {\n            main: {\n                intensity: 1,\n                shadow: true,\n                shadowQuality: 'high'\n            },\n            ambient: {\n                intensity: 0\n            },\n            ambientCubemap: {\n                texture: '/asset/get/s/data-1491838644249-ry33I7YTe.hdr',\n                exposure: 1,\n                diffuseIntensity: 0.5,\n                specularIntensity: 2\n            }\n        }\n    },\n    series: [{\n        type: 'lines3D',\n\n        coordinateSystem: 'maptalks3D',\n\n        \n\n        blendMode: 'lighter',\n            effect: {\n                show: true,\n                trailWidth: 1,\n                trailOpacity: 0.5,\n                trailLength: 0.2,\n                constantSpeed: 5\n            },\n\n        data: [],\n        polyline: true,\n        large: true,\n\n        lineStyle: {\n            //color: 'orange',\n            //width: 0.5,\n            opacity: 0.5\n        }\n    }]\n}\n\n\n$.getJSON(uploadedDataURL, function(linedata) { //读取可视化数据\nmyChart.hideLoading();\n\n    var data = []\n\n    for (var i = 0; i < linedata.length; i += 1) {\n            var linedatatmp = []\n    for (var j = 0; j < linedata[i].length; j += 1) {\nif(linedata[i].length>0){\n        loncol = linedata[i][j][0]\n        latcol = linedata[i][j][1]\n        \n        coor = coltowgs(loncol, latcol)\n        linedatatmp.push( [coor[0], coor[1]])}\n    }\n        data.push(linedatatmp)\n    }\n\n    option.visualMap.max = 30000\n    option.series[0].data = data\n\n\n\nif (option && typeof option === \"object\") {\n    myChart.setOption(option, true);\n}\n});\n\n "}