{"code":"var lineList = [\r\n    \"1\", \"10\", \"11\"\r\n];\r\nvar lineData = new Array();\r\nvar busline = null;\r\nvar lineTag = 0;\r\nvar hStep = 300 / (lineList.length - 1);\r\noption = {\r\n    bmap: {\r\n        center: [112.594099,37.866561],\r\n        zoom: 12,\r\n        roam: true,\r\n        enableMapClick: false,\r\n        mapStyle: {\r\n            'styleJson': [{\r\n                \"featureType\": \"water\",\r\n                \"elementType\": \"all\",\r\n                \"stylers\": {\r\n                    \"color\": \"#021019\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"highway\",\r\n                \"elementType\": \"geometry.fill\",\r\n                \"stylers\": {\r\n                    \"color\": \"#000000\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"highway\",\r\n                \"elementType\": \"geometry.stroke\",\r\n                \"stylers\": {\r\n                    \"color\": \"#147a92\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"arterial\",\r\n                \"elementType\": \"geometry.fill\",\r\n                \"stylers\": {\r\n                    \"color\": \"#000000\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"arterial\",\r\n                \"elementType\": \"geometry.stroke\",\r\n                \"stylers\": {\r\n                    \"color\": \"#0b3d51\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"local\",\r\n                \"elementType\": \"geometry\",\r\n                \"stylers\": {\r\n                    \"color\": \"#000000\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"land\",\r\n                \"elementType\": \"all\",\r\n                \"stylers\": {\r\n                    \"color\": \"#08304b\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"railway\",\r\n                \"elementType\": \"geometry.fill\",\r\n                \"stylers\": {\r\n                    \"color\": \"#000000\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"railway\",\r\n                \"elementType\": \"geometry.stroke\",\r\n                \"stylers\": {\r\n                    \"color\": \"#08304b\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"subway\",\r\n                \"elementType\": \"geometry\",\r\n                \"stylers\": {\r\n                    \"lightness\": -70\r\n                }\r\n            }, {\r\n                \"featureType\": \"building\",\r\n                \"elementType\": \"geometry.fill\",\r\n                \"stylers\": {\r\n                    \"color\": \"#000000\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"all\",\r\n                \"elementType\": \"labels.text.fill\",\r\n                \"stylers\": {\r\n                    \"color\": \"#857f7f\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"all\",\r\n                \"elementType\": \"labels.text.stroke\",\r\n                \"stylers\": {\r\n                    \"color\": \"#000000\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"building\",\r\n                \"elementType\": \"geometry\",\r\n                \"stylers\": {\r\n                    \"color\": \"#022338\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"green\",\r\n                \"elementType\": \"geometry\",\r\n                \"stylers\": {\r\n                    \"color\": \"#062032\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"boundary\",\r\n                \"elementType\": \"all\",\r\n                \"stylers\": {\r\n                    \"color\": \"#1e1c1c\"\r\n                }\r\n            }, {\r\n                \"featureType\": \"manmade\",\r\n                \"elementType\": \"all\",\r\n                \"stylers\": {\r\n                    \"color\": \"#022338\"\r\n                }\r\n            }]\r\n        }\r\n    },\r\n    series: [{\r\n        type: 'lines',\r\n        coordinateSystem: 'bmap',\r\n        polyline: true,\r\n        data: lineData,\r\n        silent: true,\r\n        lineStyle: {\r\n            normal: {\r\n                opacity: 0.2,\r\n                width: 1\r\n            }\r\n        },\r\n        progressiveThreshold: 500,\r\n        progressive: 100\r\n    }, {\r\n        type: 'lines',\r\n        coordinateSystem: 'bmap',\r\n        polyline: true,\r\n        data: lineData,\r\n        lineStyle: {\r\n            normal: {\r\n                width: 0.02\r\n            }\r\n        },\r\n        effect: {\r\n            constantSpeed: 40,\r\n            show: true,\r\n            trailLength: 0.02,\r\n            symbolSize: 2\r\n        },\r\n        zlevel: 1\r\n    }]\r\n};\r\n//动态添加查询到的线路数据\r\nvar addLineData = function(points) {\r\n    var bPoints = new Array();\r\n    for (var i = 0; i < points.length; i++) {\r\n        bPoints.push([points[i].lng, points[i].lat]);\r\n    }\r\n    lineData.push({\r\n        \"coords\": bPoints,\r\n        lineStyle: {\r\n            \"normal\": {\r\n                \"color\": echarts.color.modifyHSL('#5A94DF', Math.round(hStep * lineTag))\r\n            }\r\n        }\r\n    });\r\n\r\n    var tmpOption = {\r\n        series: [{\r\n        \ttype: 'lines',\r\n            data: lineData\r\n        }, {\r\n        \ttype: 'lines',\r\n            data: lineData\r\n        }]\r\n    };\r\n    myChart.setOption(tmpOption);\r\n};\r\n//查询线路数据\r\nvar searchBusLine = function(busName) {\r\n    if (busline == null) {\r\n        busline = new BMap.BusLineSearch(\"太原\", {\r\n            //renderOptions: {panel: \"r-result\", autoViewport: false },\r\n            onGetBusListComplete: function(result) {\r\n                if (result) {\r\n                    var fstLine = result.getBusListItem(0);\r\n                    busline.getBusLine(fstLine);\r\n                }\r\n            },\r\n            onGetBusLineComplete: function(e) {\r\n                console.log(e.getPath());\r\n                addLineData(e.getPath());\r\n                lineTag++;\r\n                if (lineTag < lineList.length) {\r\n                    searchBusLine(lineList[lineTag]);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    busline.getBusList(busName);\r\n};\r\n$(function() {\r\n    searchBusLine(lineList[lineTag]);\r\n});"}