{"code":"const totalData = [\n    {\n        year: '2004',\n        data: [\n            { name: '未知', value: '29.5' },\n            { name: '男性', value: '55.4' },\n            { name: '女性', value: '1.8' },\n        ],\n    },\n    {\n        year: '2007',\n        data: [\n            { name: '未知', value: '25.9' },\n            { name: '男性', value: '49.2' },\n            { name: '女性', value: '0.9' },\n        ],\n    },\n    {\n        year: '2010',\n        data: [\n            { name: '未知', value: '25.2' },\n            { name: '男性', value: '47.7' },\n            { name: '女性', value: '1.8' },\n        ],\n    },\n    {\n        year: '2013',\n        data: [\n            { name: '未知', value: '22.4' },\n            { name: '男性', value: '43.1' },\n            { name: '女性', value: '1.4' },\n        ],\n    },\n    {\n        year: '2015',\n        data: [\n            { name: '未知', value: '23.4' },\n            { name: '男性', value: '44.7' },\n            { name: '女性', value: '0.8' },\n        ],\n    },\n];\n\nconst newSeriesData = [];\nconst xData = totalData\n    .map((x) => x.year)\n    .sort(function (a, b) {\n        return a - b;\n    });\nconst legendData = totalData[0]['data'].map((x) => x.name);\nconst formatXData = [+xData[0]];\nwhile (+formatXData[formatXData.length - 1] <= +xData[xData.length - 1]) {\n    const s = +formatXData[formatXData.length - 1] + 1;\n    formatXData.push(s);\n}\ntotalData.forEach((item) => {\n    item.data.forEach((x) => {\n        const idx = newSeriesData.findIndex((d) => d.name === x.name);\n        if (idx >= 0) {\n            newSeriesData[idx].data.push([item.year, x.value]);\n        } else {\n            const para = {\n                name: x.name,\n                type: 'line',\n                data: [],\n            };\n            para.data.push([item.year, x.value]);\n            newSeriesData.push(para);\n        }\n    });\n});\nconst Xlabels = newSeriesData[0].data.map((item) => item[0]); // 用于筛选有数据的横坐标\n\noption = {\n    tooltip: {\n        trigger: 'axis',\n        formatter(params) {\n            let res = params[0].data[0]+'年';\n            for (let i = 0; i < params.length; i++) {\n                res += '<br>' + params[i].marker + params[i].seriesName + ': ' + \n                params[i].data[1]+\"%\";\n            }\n            return res;\n        },\n    },\n    color: ['red', 'blue', 'green', 'purple'],\n    legend: {\n        orient: 'vertical',\n        itemHeight: 15,\n        itemWidth: 15,\n        icon: 'rect',\n        itemGap: 10,\n        data: legendData,\n        left: '91%',\n        x: 'right',\n        y: 'center',\n    },\n    grid: {\n        left: '10%',\n        right: '10%',\n        bottom: 70,\n        containLabel: true\n    },\n    toolbox: {\n        feature: {},\n    },\n    xAxis: {\n        name: '年份',\n        // type: 'year',\n        type: 'category',\n        boundaryGap: true,\n        // splitNumber: xData.length - 1 || 0,\n        axisTick: {\n            // show: true\n            alignWithLabel: true,\n        },\n        // offset: '10%',\n        splitLine: {\n            //网格线\n            show: false,\n        },\n        axisLabel: {\n            // 横坐标间隔\n            interval(index, value) {\n                if (Xlabels.includes(value)) {\n                    return true;\n                }\n            },\n            show: true,\n            textStyle: {\n                fontSize: 16,\n            }\n        },\n        data: formatXData,\n    },\n    yAxis: [\n        {\n            type: 'value',\n            axisLabel: {\n                show: true,\n                textStyle: {\n                    fontSize: 14,\n                },\n            },\n        },\n        {\n            name: '（%）',\n            position: 'left',\n            nameLocation: 'center',\n            nameGap: 40, //与轴线间距\n            nameTextStyle: {\n                fontSize: 16,\n            },\n        },\n    ],\n    series: newSeriesData,\n};\n"}