{"code":"var img = new Image();\nvar canvas = document.createElement('canvas');\nvar ctx = canvas.getContext('2d');\n\nimg.onload = function () {\n    var width = canvas.width = img.width;\n    var height = canvas.height = img.height;\n    ctx.drawImage(img, 0, 0, width, height);\n    var imgData = ctx.getImageData(0, 0, width, height);\n    \n    // StackBlur.imageDataRGBA(imgData, 5);\n    \n    var data = [];\n    for (var i = 0; i < imgData.data.length / 4; i++) {\n        var r = imgData.data[i * 4];\n        var g = imgData.data[i * 4 + 1];\n        var b = imgData.data[i * 4 + 2];\n        \n        var lum = (0.2125 * r + 0.7154 * g + 0.0721 * b);\n        lum = (lum - 125) / 4 + 50;\n        data.push([i % width, height - Math.floor(i / width), lum]);\n    }\n    \n    \n    myChart.setOption(option = {\n        tooltip: {},\n        backgroundColor: '#fff',\n        xAxis3D: {\n            type: 'value'\n        },\n        yAxis3D: {\n            type: 'value'\n        },\n        zAxis3D: {\n            type: 'value',\n            min: 0,\n            max: 100\n        },\n        grid3D: {\n            show: false,\n            viewControl: {\n                alpha: 70,\n                beta: 0\n            },\n            postEffect: {\n                enable: true,\n                depthOfField: {\n                    enable: true,\n                    blurRadius: 4,\n                    fstop: 10\n                }\n                // SSAO: {\n                //     enable: true\n                // }\n            },\n            boxDepth: 100,\n            boxHeight: 20,\n            environment: '/asset/get/s/data-1491837999815-H1_44Qtal.jpg',\n            light: {\n                main: {\n                    shadow: true,\n                    intensity: 2\n                },\n                ambientCubemap: {\n                    texture: '/asset/get/s/data-1491896094618-H1DmP-5px.hdr',\n                    exposure: 2,\n                    diffuseIntensity: 0.2\n                }\n            }\n        },\n        series: [{\n            type: 'bar3D',\n            shading: 'lambert',\n            barSize: 0.8,\n            silent: true,\n            itemStyle: {\n                color: function (params) {\n                    var i = params.dataIndex;\n                    var r = imgData.data[i * 4] / 255;\n                    var g = imgData.data[i * 4 + 1] / 255;\n                    var b = imgData.data[i * 4 + 2] / 255;\n                    var lum = (0.2125 * r + 0.7154 * g + 0.0721 * b);\n                    r *= lum * 2;\n                    g *= lum * 2;\n                    b *= lum * 2;\n                    return [r, g, b, 1];\n                }  \n            },\n            data: data\n        }]\n    });\n}\n\nimg.src = '/asset/get/s/data-1492698053060-By6aXrIAl.jpeg';\n"}