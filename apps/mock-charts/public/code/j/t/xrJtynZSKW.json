{"code":"var gdp = \"/asset/get/s/data-1504149403899-B1VjkbrYb.json\";\nvar suicide = \"/asset/get/s/data-1504148156995-HJB69eHtZ.json\";\n\nvar series = [];\nfor (var i = 0; i < 4; ++i) {\n    series.push({\n        name: 2000 + i * 5 + '',\n        type: 'scatter',\n        data: [],\n        label: {\n            normal: {\n                show: true,\n                formatter: '{b}',\n                position: 'right'\n            }\n        }\n    })\n}\n\noption = {\n    xAxis: {\n        name: 'GDP 增长率',\n        max: 30,\n        min: -30\n    },\n    yAxis: {\n        name: '自杀人数（每万人）',\n        max: 50,\n        min: 0\n    },\n    series: series,\n    legend: {\n        data: ['2000', '2005', '2010', '2015'],\n        selectedMode: 'single'\n    },\n    dataZoom: [{\n        type: 'slider',\n        startValue: -2,\n        endValue: 12\n    }, {\n        type: 'slider',\n        startValue: 0,\n        endValue: 20,\n        yAxisIndex: 0\n    }, {\n        type: 'inside'\n    }, {\n        type: 'inside',\n        yAxisIndex: 0\n    }]\n};\n\n$.getJSON(gdp, function (res) {\n    getSuicide(res);\n});\n\nfunction getSuicide(gdpData) {\n    $.getJSON(suicide, function (res) {\n        // data for 2000, 2005, 2010, 2015\n        var suiData = [[], [], [], []];\n        for (var i = 0; i < res.fact.length; ++i) {\n            var year = res.fact[i].dims.YEAR;\n            var sid = (parseInt(year, 10) - 2000) / 5;\n            \n            if (sid >= 0 && sid < res.fact.length \n                && res.fact[i].dims.SEX === 'Both sexes'\n            ) {\n                var country = res.fact[i].dims.COUNTRY;\n                var gdp = getGdp(gdpData, country, sid);\n                if (gdp && gdp !== '-') {\n                    var itemStyle = {};\n                    if (country === 'China') {\n                        itemStyle = {\n                            normal: {\n                                borderColor: 'yellow',\n                                borderWidth: 3\n                            }\n                        }\n                    }\n                    suiData[sid].push({\n                        name: country,\n                        value: [gdp, parseFloat(res.fact[i].Value)],\n                        itemStyle: itemStyle\n                    });\n                }\n            }\n        }\n        \n        var series = [];\n        for (var i = 0; i < suiData.length; ++i) {\n            series.push({\n                type: 'scatter',\n                data: suiData[i]\n            });\n        }\n        \n        myChart.setOption({\n            series: series\n        });\n    });\n}\n\nfunction getGdp(data, country, sid) {\n    for (var i = 0; i < data.length; ++i) {\n        if (country.indexOf(data[i][0]) > -1) {\n            return data[i][sid + 1];\n        }\n    }\n    return '-';\n}\n"}