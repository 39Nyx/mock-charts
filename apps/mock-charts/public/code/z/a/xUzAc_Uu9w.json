{"code":"const cellSize = [80, 80];\nconst pieRadius = 30;\n// 得到虚拟的散点数据\nfunction getVirtulData() {\n  let date = +echarts.number.parseDate('2021-01-01');\n  let end = +echarts.number.parseDate('2021-03-01');\n  let dayTime = 3600 * 24 * 1000;\n  let data = [];\n  for (let time = date; time < end; time += dayTime) {\n    data.push([\n      echarts.format.formatTime('yyyy-MM-dd', time),\n      Math.floor(Math.random() * 500)\n    ]);\n  }\n  return data;\n}\n// 在日历坐标系中根据每个散点得到一个饼图\nfunction getPieSeries(scatterData, chart) {\n  return scatterData.map(function (item, index) {\n    var center = chart.convertToPixel('calendar', item);\n    return {\n      id: index + 'pie',\n      type: 'pie',\n      center: center,\n      label: {\n        formatter: '{c}',\n        position: 'inside'\n      },\n      radius: pieRadius,\n      data: [\n        { name: '优', value: Math.round(Math.random() * 24) },\n        { name: '良', value: Math.round(Math.random() * 24) },\n        { name: '轻度污染', value: Math.round(Math.random() * 24) },\n        { name: '中度污染', value: Math.round(Math.random() * 24) },\n        { name: '重度污染', value: Math.round(Math.random() * 24) },\n        { name: '严重污染', value: Math.round(Math.random() * 24) }\n      ]\n    };\n  });\n}\n\nvar scatterData = getVirtulData();\noption = {\n  tooltip: {},\n  legend: {\n        data: ['优', '良', '轻度污染', '中度污染', '重度污染', '严重污染'],\n        bottom: 20\n    },\n    color: [\n        '#00E400', '#FFFF00', '#FF7E00', '#FF0000',\n        '#99004C', '#7E0023'\n    ],\n  calendar: {\n    top: 'middle',\n    left: 'center',\n    orient: 'vertical',\n    cellSize: cellSize,\n    yearLabel: {\n      show: false,\n      fontSize: 30\n    },\n    dayLabel: {\n      margin: 20,\n      firstDay: 1,\n      nameMap: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\n    },\n    monthLabel: {\n      show: true,\n      nameMap: 'cn',\n    },\n    range: ['2021-01', '2021-02-28']\n  },\n  series: [\n    {\n      id: 'label',\n      type: 'scatter',\n      coordinateSystem: 'calendar',\n      symbolSize: 0,\n      label: {\n        show: true,\n        formatter: function (params) {\n          return echarts.format.formatTime('dd', params.value[0]);\n        },\n        offset: [-cellSize[0] / 2 + 10, -cellSize[1] / 2 + 10],\n        fontSize: 14\n      },\n      data: scatterData\n    }\n  ]\n};\n\nsetTimeout(function () {\n  myChart.setOption({\n    series: getPieSeries(scatterData, myChart)\n  });\n}, 10);\n"}