{"code":"/************************************************\n * 机器出现故障的时间段,Y轴代表小时数,X代表异常机器\n ************************************************/\nvar xAxis = ['机器A','机器B','机器C','机器D'];\nvar minHour = 0;\nvar maxHour = 24;\n//模拟数据,一个开始时间,对应一个结束时间.\nvar hourData = [\n        [[3,10]],//机器A 3点钟开始异常,10点维修完成\n        [[6,8],[11,13],[20,24]],\n        [[10,15]],\n        [[5,10]]\n    ];\n\n//補缺空擋數據\nvar maxColumn = 0;//最大列\nfor (var i in hourData) {\n    var array = hourData[i];\n    var addCount = 0;//新增計數器,因每次新增后,數組長度都會實時變化\n    for (var j in array) {\n        if (j == 0 && array[j][0] > minHour) {\n            array.unshift([0,(array[j][0]-minHour),-1]);\n            addCount++;\n        } else if(j > 0){\n            var newJ = parseInt(j)+addCount;\n            var currentStart = array[newJ][0];\n            var currentEnd = array[newJ][1];\n            var beforeEnd  = array[newJ-1][1];\n            if (beforeEnd!=currentStart) {\n                array.splice(newJ,0,[beforeEnd,currentStart,-1]);\n                addCount++;\n            }\n        }\n    }\n    if (maxColumn < array.length) {\n        maxColumn = array.length;\n    }\n}\n\n//初始化每层的数据,默认空\nvar seriesArray = [];\nvar seriesBlank = [];//保存需要透明的下標\nfor (var i = 0;i<maxColumn;i++) {\n    var arrayTemp = [];\n    var arrayBlankTemp = [];\n    for (var j in hourData) {\n        var array = hourData[j][i];\n        if (!!array) {\n            var s = hourData[j][i][0];\n            var e = hourData[j][i][1];\n            arrayTemp.push(e-s);\n            if (!!hourData[j][i][2] && hourData[j][i][2] == -1) {\n                arrayBlankTemp.push('透明');\n            } else {\n                arrayBlankTemp.push('非透明');\n            }\n        } else {\n            arrayTemp.push(0);\n            arrayBlankTemp.push('透明');\n        }\n    }\n    seriesArray.push(arrayTemp);\n    seriesBlank.push(arrayBlankTemp);\n}\n\n\n//生成圖表\nvar series = [];\nfor (var i in seriesArray) {\n    series.push({\n        name:'DownTime',\n        type:'bar',\n        stack:'DownTime',\n        data:seriesArray[i],\n        barWidth:5,\n        color:function(param){\n            var blankValue = seriesBlank[param.seriesIndex][param.dataIndex];\n            if (!!blankValue && blankValue == '透明') {\n                return 'rgba(128, 128, 128, 0)';\n            }\n            return '#EB4742';\n        }\n    });\n}\n\noption = {\n    title: {\n        text: 'DownTime',\n        textStyle: {\n            color: '#707070',\n            fontSize:'12',\n            fontWeight:'normal'\n        }\n    },\n    grid: {\n        top:'30',\n        left: '0',\n        right: '0',\n        bottom: '0',\n        containLabel: true\n    },\n    xAxis : [\n        {\n            type : 'category',\n            data : xAxis\n        }\n    ],\n    yAxis : [\n        {\n            type : 'value',\n            min:minHour,\n            max:maxHour\n        }\n    ],\n    series : series\n};\n"}