{"code":"var data = [\n    {name: '廊坊', value: 193},\n    {name: '大庆', value: 279},\n    {name: '校门', value: 139},\n    {name: '图书馆', value: 124},\n    {name: '食堂1', value: 125},\n    {name: '食堂2', value: 129},\n     {name: '小卖部', value: 314}\n];\n\nvar geoCoordMap = {\n    '廊坊':[116.7,39.53],\n    '大庆':[125.03,46.58],\n    '校门':[108.622163,21.89902],\n    '图书馆':[1108.62217,21.903713],\n    '食堂1':[108.623985,21.903479],\n    '食堂2':[108.626084,21.901846],\n    '小卖部':[108.626136,21.907171]\n};\n\n\nvar convertData = function (data) {\n    var res = [];\n    for (var i = 0; i < data.length; i++) {\n        var geoCoord = geoCoordMap[data[i].name];\n        if (geoCoord) {\n            res.push({\n                name: data[i].name,\n                value: geoCoord.concat(data[i].value)\n            });\n        }\n    }\n    return res;\n};\n\nfunction renderItem(params, api) {\n    var coords = [\n        [116.7,39.53],\n        [103.73,36.03],\n        [112.91,27.87],\n        [120.65,28.01],\n        [119.57,39.95]\n    ];\n    var points = [];\n    for (var i = 0; i < coords.length; i++) {\n        points.push(api.coord(coords[i]));\n    }\n    var color = api.visual('color');\n\n    return {\n        type: 'polygon',\n        shape: {\n            points: echarts.graphic.clipPointsByRect(points, {\n                x: params.coordSys.x,\n                y: params.coordSys.y,\n                width: params.coordSys.width,\n                height: params.coordSys.height\n            })\n        },\n        style: api.style({\n            fill: color,\n            stroke: echarts.color.lift(color)\n        })\n    };\n}\n\noption = {\n    // backgroundColor: '#404a59',\n    title: {\n        text: '北部湾大学轨迹分布图',\n    },\n    tooltip : {\n        formatter: function(params) {\n            var str = params.data['value'];\n            return params.name+\":\"+\"来过\"+str[2]+\"人\";\n        },\n    },\n    bmap: {\n        center: [108.623609,21.903551],\n        zoom: 17,\n        roam: true,\n    },\n    series : [\n        {\n            name: 'pm2.5',\n            type: 'scatter',\n            coordinateSystem: 'bmap',\n            data: convertData(data),\n            symbolSize: function (val) {\n                return val[2] / 10;\n            },\n            label: {\n                normal: {\n                    formatter: '{b}',\n                    position: 'right',\n                    show: false\n                },\n                emphasis: {\n                    show: true\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#ddb926'\n                }\n            }\n        }\n    ]\n};"}